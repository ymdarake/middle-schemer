# ステップ5: クロージャとスコープ

## 目的

クロージャ（関数と環境の組み合わせ）を正しく処理し、レキシカルスコープを実装します。
外側の変数を参照できるようにします。

## 学ぶこと

- レキシカルスコープ（静的スコープ）とダイナミックスコープの違い
- クロージャの概念と実装
- 自由変数と束縛変数
- 環境の継承

## 実装内容

以下のようなコードが正しく評価できるようになります：

```scheme
(define x 10)
(define make-adder (lambda (n) (lambda (x) (+ x n))))
(define add10 (make-adder 10))
(add10 5)  ; => 15
```

ここで、`add10` は外側の `n` を参照できるクロージャです。

## スコープの仕組み

1. **束縛変数**: 関数の引数として導入される変数
2. **自由変数**: 関数内で使われるが、引数として導入されていない変数
3. **クロージャ**: 自由変数の値を環境から取得できるようにする仕組み

## 実装のポイント

1. クロージャを作成する際、現在の環境を保存
2. 関数適用時、クロージャが保持する環境を継承
3. 新しい束縛を追加した後、関数本体を評価

## 実行方法

```bash
# Gaucheの場合
gosh step-05/closures.scm

# Chez Schemeの場合
chezscheme step-05/closures.scm
```

## 次のステップ

次のステップでは、条件分岐とブール値を実装します。

